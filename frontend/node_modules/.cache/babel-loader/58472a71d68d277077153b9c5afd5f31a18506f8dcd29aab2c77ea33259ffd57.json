{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\admin\\\\chat-app\\\\frontend\\\\src\\\\context\\\\ChatContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport { io } from 'socket.io-client';\nimport { AuthContext } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ChatContext = /*#__PURE__*/createContext();\nexport const ChatProvider = ({\n  children\n}) => {\n  _s();\n  const {\n    token,\n    user\n  } = useContext(AuthContext);\n  const [socket, setSocket] = useState(null);\n  const [chats, setChats] = useState([]);\n  const [selectedChat, setSelectedChat] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [typingUser, setTypingUser] = useState(null);\n  useEffect(() => {\n    if (user && token) {\n      const newSocket = io('http://localhost:5000', {\n        auth: {\n          token\n        }\n      });\n      newSocket.emit('user_join', user.id);\n      newSocket.on('receive_message', data => {\n        setMessages(prev => [...prev, data]);\n      });\n      newSocket.on('user_online', data => {\n        setOnlineUsers(prev => [...new Set([...prev, data.userId])]);\n      });\n      newSocket.on('user_offline', data => {\n        setOnlineUsers(prev => prev.filter(id => id !== data.userId));\n      });\n      newSocket.on('user_typing', data => {\n        setTypingUser(data.username);\n      });\n      newSocket.on('user_stop_typing', () => {\n        setTypingUser(null);\n      });\n      setSocket(newSocket);\n      return () => newSocket.disconnect();\n    }\n  }, [user, token]);\n  const sendMessage = (chatId, content) => {\n    if (socket) {\n      socket.emit('send_message', {\n        chatId,\n        message: content\n      });\n    }\n  };\n  const joinChat = chatId => {\n    if (socket) {\n      socket.emit('join_chat', chatId);\n    }\n  };\n  const emitTyping = (chatId, username) => {\n    if (socket) {\n      socket.emit('typing', {\n        chatId,\n        username\n      });\n    }\n  };\n  const emitStopTyping = chatId => {\n    if (socket) {\n      socket.emit('stop_typing', {\n        chatId\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(ChatContext.Provider, {\n    value: {\n      socket,\n      chats,\n      setChats,\n      selectedChat,\n      setSelectedChat,\n      messages,\n      setMessages,\n      onlineUsers,\n      typingUser,\n      sendMessage,\n      joinChat,\n      emitTyping,\n      emitStopTyping\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatProvider, \"B63Xjc0a8a1oxG7lrcQpjCX158Q=\");\n_c = ChatProvider;\nvar _c;\n$RefreshReg$(_c, \"ChatProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","io","AuthContext","jsxDEV","_jsxDEV","ChatContext","ChatProvider","children","_s","token","user","socket","setSocket","chats","setChats","selectedChat","setSelectedChat","messages","setMessages","onlineUsers","setOnlineUsers","typingUser","setTypingUser","newSocket","auth","emit","id","on","data","prev","Set","userId","filter","username","disconnect","sendMessage","chatId","content","message","joinChat","emitTyping","emitStopTyping","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/admin/chat-app/frontend/src/context/ChatContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\r\nimport { io } from 'socket.io-client';\r\nimport { AuthContext } from './AuthContext';\r\n\r\nexport const ChatContext = createContext();\r\n\r\nexport const ChatProvider = ({ children }) => {\r\n  const { token, user } = useContext(AuthContext);\r\n  const [socket, setSocket] = useState(null);\r\n  const [chats, setChats] = useState([]);\r\n  const [selectedChat, setSelectedChat] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [onlineUsers, setOnlineUsers] = useState([]);\r\n  const [typingUser, setTypingUser] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (user && token) {\r\n      const newSocket = io('http://localhost:5000', {\r\n        auth: { token }\r\n      });\r\n\r\n      newSocket.emit('user_join', user.id);\r\n\r\n      newSocket.on('receive_message', (data) => {\r\n        setMessages(prev => [...prev, data]);\r\n      });\r\n\r\n      newSocket.on('user_online', (data) => {\r\n        setOnlineUsers(prev => [...new Set([...prev, data.userId])]);\r\n      });\r\n\r\n      newSocket.on('user_offline', (data) => {\r\n        setOnlineUsers(prev => prev.filter(id => id !== data.userId));\r\n      });\r\n\r\n      newSocket.on('user_typing', (data) => {\r\n        setTypingUser(data.username);\r\n      });\r\n\r\n      newSocket.on('user_stop_typing', () => {\r\n        setTypingUser(null);\r\n      });\r\n\r\n      setSocket(newSocket);\r\n\r\n      return () => newSocket.disconnect();\r\n    }\r\n  }, [user, token]);\r\n\r\n  const sendMessage = (chatId, content) => {\r\n    if (socket) {\r\n      socket.emit('send_message', { chatId, message: content });\r\n    }\r\n  };\r\n\r\n  const joinChat = (chatId) => {\r\n    if (socket) {\r\n      socket.emit('join_chat', chatId);\r\n    }\r\n  };\r\n\r\n  const emitTyping = (chatId, username) => {\r\n    if (socket) {\r\n      socket.emit('typing', { chatId, username });\r\n    }\r\n  };\r\n\r\n  const emitStopTyping = (chatId) => {\r\n    if (socket) {\r\n      socket.emit('stop_typing', { chatId });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ChatContext.Provider value={{\r\n      socket,\r\n      chats,\r\n      setChats,\r\n      selectedChat,\r\n      setSelectedChat,\r\n      messages,\r\n      setMessages,\r\n      onlineUsers,\r\n      typingUser,\r\n      sendMessage,\r\n      joinChat,\r\n      emitTyping,\r\n      emitStopTyping\r\n    }}>\r\n      {children}\r\n    </ChatContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}